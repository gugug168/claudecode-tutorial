# Go-Reviewerï¼ˆGoä»£ç å®¡æŸ¥ä»£ç†ï¼‰

## ä¸€å¥è¯æ€»ç»“
Go-Reviewer æ˜¯ä¸€ä¸ªGoè¯­è¨€ä»£ç å®¡æŸ¥ä¸“å®¶ï¼Œå®ƒä¸“é—¨æ£€æŸ¥Goä»£ç çš„æƒ¯ç”¨å†™æ³•ã€å¹¶å‘æ¨¡å¼ã€é”™è¯¯å¤„ç†å’Œæ€§èƒ½é—®é¢˜ï¼Œç¡®ä¿ä»£ç ç¬¦åˆGoçš„æœ€ä½³å®è·µã€‚

---

## å®ƒæ˜¯ä»€ä¹ˆï¼Ÿï¼ˆå°ç™½è§†è§’ï¼‰

### ç”¨ä¸€ä¸ªæ¯”å–»æ¥ç†è§£

æƒ³è±¡ä½ åœ¨ç”¨ä¸­æ–‡å†™æ–‡ç« ï¼š

- **é€šç”¨ Code-Reviewer**ï¼šæ£€æŸ¥è¯­æ³•ã€é€»è¾‘ã€ä¸€èˆ¬é—®é¢˜
- **Go-Reviewer**ï¼šä¸“é—¨æ£€æŸ¥ä½ çš„ä¸­æ–‡æ˜¯å¦åœ°é“ã€æ˜¯å¦ç¬¦åˆä¸­æ–‡ä¹ æƒ¯ç”¨æ³•

**Go-Reviewer å°±æ˜¯é‚£ä½"åœ°é“è¡¨è¾¾ä¸“å®¶"**ï¼Œå®ƒç¡®ä¿ä½ çš„Goä»£ç å†™å¾—åƒGoï¼Œè€Œä¸æ˜¯"ç”¨Goè¯­æ³•å†™çš„Java"ã€‚

### Goçš„ç‰¹æ®Šä¹‹å¤„

| Goç‰¹ç‚¹ | è¯´æ˜ |
|--------|------|
| æ˜¾å¼é”™è¯¯å¤„ç† | æ²¡æœ‰ try-catchï¼Œç”¨è¿”å›å€¼å¤„ç†é”™è¯¯ |
| å¹¶å‘åŸç”Ÿæ”¯æŒ | goroutine å’Œ channel |
| ç®€æ´çš„è¯­æ³• | æ•…æ„è®¾è®¡å¾—ç®€å• |
| å¼ºå¤§çš„æ ‡å‡†åº“ | å¾ˆå¤šåŠŸèƒ½ä¸éœ€è¦ç¬¬ä¸‰æ–¹åº“ |

---

## å·¥ä½œåŸç†

```
Goä»£ç å˜æ›´ â”€â”€â†’ Go-Reviewer â”€â”€â†’ git diff -- '*.go'
    â”‚                               â”‚
    â”‚                               â†“
    â”‚                          go vet / staticcheck
    â”‚                               â”‚
    â”‚                               â†“
    â”‚                          èšç„¦ä¿®æ”¹çš„.goæ–‡ä»¶
    â”‚                               â”‚
    â”‚                               â†“
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†â”€â”€â”€â”€â”€â”€â”€â”€â”€ å¼€å§‹å®¡æŸ¥
```

---

## é…ç½®è¯¦è§£

```yaml
---
name: go-reviewer                                    # ä»£ç†åç§°
description: Expert Go code reviewer...              # æè¿°
tools: ["Read", "Grep", "Glob", "Bash"]             # åªè¯»å·¥å…·
model: sonnet                                        # ä½¿ç”¨Sonnetæ¨¡å‹
---
```

---

## å®¡æŸ¥ä¼˜å…ˆçº§

### ğŸ”´ CRITICAL â€” å®‰å…¨

| é—®é¢˜ | è¯´æ˜ |
|------|------|
| **SQLæ³¨å…¥** | database/sqlä¸­ä½¿ç”¨å­—ç¬¦ä¸²æ‹¼æ¥ |
| **å‘½ä»¤æ³¨å…¥** | os/execä¸­æœªéªŒè¯çš„è¾“å…¥ |
| **è·¯å¾„éå†** | ç”¨æˆ·æ§åˆ¶çš„æ–‡ä»¶è·¯å¾„æœªä½¿ç”¨ `filepath.Clean` + å‰ç¼€æ£€æŸ¥ |
| **ç«æ€æ¡ä»¶** | å…±äº«çŠ¶æ€æ²¡æœ‰åŒæ­¥ |
| **UnsafeåŒ…** | æ— æ­£å½“ç†ç”±ä½¿ç”¨unsafe |
| **ç¡¬ç¼–ç å¯†é’¥** | æºç ä¸­çš„APIå¯†é’¥ã€å¯†ç  |
| **ä¸å®‰å…¨TLS** | `InsecureSkipVerify: true` |

### ğŸ”´ CRITICAL â€” é”™è¯¯å¤„ç†

| é—®é¢˜ | è¯´æ˜ |
|------|------|
| **å¿½ç•¥é”™è¯¯** | ä½¿ç”¨ `_` ä¸¢å¼ƒé”™è¯¯ |
| **ç¼ºå°‘é”™è¯¯åŒ…è£…** | `return err` è€Œé `fmt.Errorf("context: %w", err)` |
| **å¯æ¢å¤é”™è¯¯ç”¨panic** | åº”è¯¥ç”¨é”™è¯¯è¿”å› |
| **ç¼ºå°‘errors.Is/As** | ä½¿ç”¨ `err == target` è€Œé `errors.Is(err, target)` |

### ğŸŸ  HIGH â€” å¹¶å‘

| é—®é¢˜ | è¯´æ˜ |
|------|------|
| **Goroutineæ³„æ¼** | æ²¡æœ‰å–æ¶ˆæœºåˆ¶ï¼ˆåº”ä½¿ç”¨ `context.Context`ï¼‰ |
| **æ— ç¼“å†²channelæ­»é”** | å‘é€æ²¡æœ‰æ¥æ”¶è€… |
| **ç¼ºå°‘sync.WaitGroup** | Goroutineæ²¡æœ‰åè°ƒ |
| **Mutexè¯¯ç”¨** | æ²¡æœ‰ä½¿ç”¨ `defer mu.Unlock()` |

### ğŸŸ  HIGH â€” ä»£ç è´¨é‡

| é—®é¢˜ | è¯´æ˜ |
|------|------|
| **å¤§å‡½æ•°** | è¶…è¿‡50è¡Œ |
| **æ·±åµŒå¥—** | è¶…è¿‡4å±‚ |
| **éæƒ¯ç”¨** | if/elseè€Œéæ—©è¿”å› |
| **åŒ…çº§å˜é‡** | å¯å˜å…¨å±€çŠ¶æ€ |
| **æ¥å£æ±¡æŸ“** | å®šä¹‰æœªä½¿ç”¨çš„æŠ½è±¡ |

### ğŸŸ¡ MEDIUM â€” æ€§èƒ½

| é—®é¢˜ | è¯´æ˜ |
|------|------|
| **å¾ªç¯ä¸­å­—ç¬¦ä¸²æ‹¼æ¥** | åº”ä½¿ç”¨ `strings.Builder` |
| **ç¼ºå°‘åˆ‡ç‰‡é¢„åˆ†é…** | `make([]T, 0, cap)` |
| **N+1æŸ¥è¯¢** | å¾ªç¯ä¸­çš„æ•°æ®åº“æŸ¥è¯¢ |
| **ä¸å¿…è¦çš„åˆ†é…** | çƒ­è·¯å¾„ä¸­çš„å¯¹è±¡ |

### ğŸŸ¡ MEDIUM â€” æœ€ä½³å®è·µ

| é—®é¢˜ | è¯´æ˜ |
|------|------|
| **Contextä¸æ˜¯ç¬¬ä¸€ä¸ª** | `ctx context.Context` åº”è¯¥æ˜¯ç¬¬ä¸€ä¸ªå‚æ•° |
| **éè¡¨é©±åŠ¨æµ‹è¯•** | æµ‹è¯•åº”è¯¥ä½¿ç”¨è¡¨é©±åŠ¨æ¨¡å¼ |
| **é”™è¯¯æ¶ˆæ¯æ ¼å¼** | å°å†™ï¼Œæ— æ ‡ç‚¹ |
| **åŒ…å‘½å** | çŸ­ã€å°å†™ã€æ— ä¸‹åˆ’çº¿ |
| **å¾ªç¯ä¸­çš„defer** | èµ„æºç§¯ç´¯é£é™© |

---

## å¸¸è§é”™è¯¯ç¤ºä¾‹

### SQLæ³¨å…¥

```go
// âŒ é”™è¯¯: SQLæ³¨å…¥
query := fmt.Sprintf("SELECT * FROM users WHERE id = %s", userID)

// âœ… æ­£ç¡®: å‚æ•°åŒ–æŸ¥è¯¢
query := "SELECT * FROM users WHERE id = ?"
row := db.QueryRow(query, userID)
```

### é”™è¯¯å¤„ç†

```go
// âŒ é”™è¯¯: å¿½ç•¥é”™è¯¯
_, _ = file.Write(data)  // é”™è¯¯è¢«å¿½ç•¥

// âœ… æ­£ç¡®: å¤„ç†é”™è¯¯
if _, err := file.Write(data); err != nil {
    return fmt.Errorf("failed to write data: %w", err)
}
```

### é”™è¯¯æ¯”è¾ƒ

```go
// âŒ é”™è¯¯: ç›´æ¥æ¯”è¾ƒ
if err == io.EOF { ... }

// âœ… æ­£ç¡®: ä½¿ç”¨errors.Is
if errors.Is(err, io.EOF) { ... }
```

### Contextä½ç½®

```go
// âŒ é”™è¯¯: Contextä¸æ˜¯ç¬¬ä¸€ä¸ª
func DoSomething(id int, ctx context.Context) error { ... }

// âœ… æ­£ç¡®: Contextç¬¬ä¸€ä¸ª
func DoSomething(ctx context.Context, id int) error { ... }
```

### å­—ç¬¦ä¸²æ‹¼æ¥

```go
// âŒ é”™è¯¯: å¾ªç¯ä¸­æ‹¼æ¥
var s string
for _, item := range items {
    s += item.Name  // æ¯æ¬¡éƒ½åˆ†é…æ–°å†…å­˜
}

// âœ… æ­£ç¡®: strings.Builder
var sb strings.Builder
for _, item := range items {
    sb.WriteString(item.Name)
}
s := sb.String()
```

### åˆ‡ç‰‡é¢„åˆ†é…

```go
// âŒ é”™è¯¯: åŠ¨æ€å¢é•¿
var results []string
for _, item := range items {
    results = append(results, item.Name)  // å¯èƒ½å¤šæ¬¡é‡æ–°åˆ†é…
}

// âœ… æ­£ç¡®: é¢„åˆ†é…
results := make([]string, 0, len(items))
for _, item := range items {
    results = append(results, item.Name)
}
```

### Mutexä½¿ç”¨

```go
// âŒ é”™è¯¯: å¯èƒ½å¿˜è®°è§£é”
mu.Lock()
doSomething()
mu.Unlock()  // å¦‚æœdoSomething panicï¼Œä¸ä¼šè§£é”

// âœ… æ­£ç¡®: deferè§£é”
mu.Lock()
defer mu.Unlock()
doSomething()  // å³ä½¿panicä¹Ÿä¼šè§£é”
```

### Goroutineæ³„æ¼

```go
// âŒ é”™è¯¯: æ²¡æœ‰å–æ¶ˆæœºåˆ¶
go func() {
    for {
        doWork()  // æ°¸è¿œè¿è¡Œï¼Œæ— æ³•åœæ­¢
    }
}()

// âœ… æ­£ç¡®: ä½¿ç”¨contextå–æ¶ˆ
ctx, cancel := context.WithCancel(context.Background())
go func() {
    for {
        select {
        case <-ctx.Done():
            return
        default:
            doWork()
        }
    }
}()
// éœ€è¦åœæ­¢æ—¶
cancel()
```

---

## è¯Šæ–­å‘½ä»¤

```bash
# é™æ€æ£€æŸ¥
go vet ./...

# æ›´å…¨é¢çš„æ£€æŸ¥
staticcheck ./...

# ç»¼åˆlinter
golangci-lint run

# ç«æ€æ£€æµ‹
go build -race ./...
go test -race ./...

# æ¼æ´æ£€æŸ¥
govulncheck ./...
```

---

## å®¡æ‰¹æ ‡å‡†

| ç»“è®º | æ¡ä»¶ |
|------|------|
| **é€šè¿‡** | æ— CRITICALæˆ–HIGHé—®é¢˜ |
| **è­¦å‘Š** | åªæœ‰MEDIUMé—®é¢˜ |
| **é˜»æ­¢** | å‘ç°CRITICALæˆ–HIGHé—®é¢˜ |

---

## ä½¿ç”¨æ–¹æ³•

### é€šè¿‡å‘½ä»¤è°ƒç”¨
```bash
/go-review
```

### æˆ–è€…æè¿°éœ€æ±‚
```
å¸®æˆ‘å®¡æŸ¥è¿™æ®µGoä»£ç 
```

---

## å·¥ä½œæµé…åˆ

```
/go-review            â† go-reviewerå®¡æŸ¥Goä»£ç 
/go-test              â† è¿è¡ŒGoæµ‹è¯•
/go-build             â† å¦‚æœæ„å»ºå¤±è´¥
```

---

## æ³¨æ„äº‹é¡¹

1. **Contextç¬¬ä¸€** - ctxå‚æ•°æ°¸è¿œæ”¾åœ¨ç¬¬ä¸€ä½
2. **é”™è¯¯è¦åŒ…è£…** - ç”¨ `%w` åŒ…è£…é”™è¯¯ä¿ç•™ä¸Šä¸‹æ–‡
3. **deferè§£é”** - Mutexå¿…é¡»ç”¨defer Unlock
4. **è¡¨é©±åŠ¨æµ‹è¯•** - Goæµ‹è¯•çš„æ ‡å‡†æ¨¡å¼
5. **ç®€å•ä¼˜å…ˆ** - Goå“²å­¦æ˜¯ä¿æŒç®€å•

---

## ç›¸å…³ä»£ç†

- **go-build-resolver** - Goæ„å»ºé”™è¯¯ä¿®å¤
- **code-reviewer** - é€šç”¨ä»£ç å®¡æŸ¥
- **security-reviewer** - å®‰å…¨å®¡æŸ¥

## ç›¸å…³æŠ€èƒ½

- `skill: golang-patterns` - è¯¦ç»†Goæ¨¡å¼å’Œä»£ç ç¤ºä¾‹
- `skill: golang-testing` - Goæµ‹è¯•æ¨¡å¼
