# 常用工作流

## 新功能开发流程

### 完整流程

```bash
# 1. 规划
/plan "添加用户认证功能"
# 等待 planner 生成计划，确认后继续

# 2. TDD 开发
/tdd
# 按照指导先写测试，再写实现

# 3. 代码审查
/code-review
# 检查代码质量和安全性

# 4. 安全扫描（可选）
/security-scan
# 深度安全审查
```

### 简化流程（快速迭代）

```bash
/tdd           # 测试驱动开发
/code-review   # 快速审查
```

---

## Bug 修复流程

### 标准流程

```bash
# 1. TDD 方式复现 bug
/tdd
# 先写一个能复现 bug 的失败测试

# 2. 实现修复
# 写最少的代码让测试通过

# 3. 审查
/code-review
# 检查是否有回归问题
```

### 关键原则
- **先写测试** - 确保真的修复了问题
- **最小改动** - 只修复问题，不做额外修改
- **审查回归** - 确保没有引入新问题

---

## 生产准备流程

```bash
# 1. 安全扫描
/security-scan
# OWASP Top 10 审计

# 2. E2E 测试
/e2e
# 关键用户流程测试

# 3. 测试覆盖率
/test-coverage
# 验证 80%+ 覆盖率

# 4. 验证循环
/verify
# 全面验证
```

---

## 重构流程

### 清理死代码

```bash
# 1. 分析并清理
/refactor-clean
# 识别并删除未使用的代码、依赖、导出

# 2. 审查变更
/code-review
# 确保没有破坏功能
```

### 安全重构

```bash
# 1. 确保有测试
/tdd
# 先补充测试（如果没有）

# 2. 重构
# 进行重构，保持测试通过

# 3. 审查
/code-review
# 检查重构质量
```

---

## Go 项目工作流

```bash
# 1. 代码审查
/go-review
# Go 惯用法审查

# 2. 测试
/go-test
# Go TDD 工作流

# 3. 构建修复（如果需要）
/go-build
# 修复 Go 构建错误
```

---

## Python 项目工作流

```bash
# 1. 代码审查
/python-review
# PEP 8、类型注解、安全审查

# 2. 测试
pytest
# 运行 pytest 测试
```

---

## 多代理协作工作流

### 复杂任务分解

```bash
# 1. 多代理规划
/multi-plan
# 将复杂任务分解给多个代理

# 2. 执行
/multi-execute
# 协调执行多代理工作流
```

### 全栈开发

```bash
# 后端优先
/multi-backend
# 后端多服务编排

# 前端优先
/multi-frontend
# 前端多服务编排
```

---

## 持续学习工作流

### 会话中学习

```bash
# 手动提取模式
/learn
# 从当前会话提取可复用模式
```

### 直觉管理

```bash
# 查看已学习的直觉
/instinct-status

# 导出直觉分享给团队
/instinct-export

# 导入团队的直觉
/instinct-import instincts.json

# 将相关直觉聚类成技能
/evolve
```

---

## 文档更新工作流

```bash
# 更新代码地图
/update-codemaps

# 更新文档
/update-docs
```

---

## 检查点工作流

用于需要多次验证的复杂任务：

```bash
# 1. 保存检查点
/checkpoint
# 保存当前验证状态

# 2. 继续开发...

# 3. 运行验证
/verify
# 验证是否满足标准

# 4. 评估
/eval
# 根据标准评估结果
```

---

## 常见场景速查表

| 场景 | 命令序列 |
|------|----------|
| 新功能 | `/plan` → `/tdd` → `/code-review` |
| 修 bug | `/tdd` → `/code-review` |
| 上线前 | `/security-scan` → `/e2e` → `/test-coverage` |
| 清理代码 | `/refactor-clean` → `/code-review` |
| Go 项目 | `/go-review` → `/go-test` → `/go-build` |
| Python 项目 | `/python-review` → `pytest` |
| 学模式 | `/learn` → `/instinct-status` |
| 更新文档 | `/update-codemaps` → `/update-docs` |

---

## 工作流最佳实践

### 1. 规划先行
对于复杂功能，先用 `/plan` 制定计划，确认后再开始。

### 2. 测试驱动
总是用 `/tdd` 或遵循 TDD 原则，先写测试再写代码。

### 3. 定期审查
完成功能后用 `/code-review` 审查，不要积累太多代码。

### 4. 安全意识
涉及用户输入、认证、敏感数据的代码，用 `/security-scan` 审查。

### 5. 持续学习
用 `/learn` 和 `/instinct-status` 跟踪你学到的模式。

### 6. 文档同步
重大变更后用 `/update-docs` 保持文档同步。
